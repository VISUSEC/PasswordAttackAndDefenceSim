<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>パスワード攻撃・防御シミュレータ - VISUSEC</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>パスワード攻撃・防御シミュレータ</h1>
        <p>攻撃者の手法を理解し、堅牢な認証システムとパスワード管理の重要性を学びます。</p>

        <div class="nav-tabs">
            <button class="nav-btn active" data-target="section-analysis">① 総当たり解析</button>
            <button class="nav-btn" data-target="section-login">② 実践ログイン・防御</button>
            <button class="nav-btn" data-target="section-spray">③ ID探索・スプレー</button>
        </div>

        <div id="section-analysis" class="tab-content active">
            <div class="input-section">
                <label for="passwordInput">ターゲットパスワードを入力:</label>
                <input type="text" id="passwordInput" placeholder="例: Yona, apple (4-6文字程度推奨)">
                
                <div class="password-suggestions">
                    <label>試すパスワードの例:</label>
                    <div class="suggest-buttons-wrapper">
                        <button class="suggest-btn" data-password="yona">yona</button>
                        <button class="suggest-btn" data-password="yonag">yonag</button>
                        <button class="suggest-btn" data-password="Yona">Yona</button>
                        <button class="suggest-btn" data-password="Yona5">Yona5</button>
                        <button class="suggest-btn" data-password="yonago">yonago</button>
                    </div>
                </div>
                
                <div class="analysis-options">
                    <label>攻撃手法の選択:</label>
                    <div class="radio-buttons-wrapper">
                        <label><input type="radio" name="attackType" value="bruteforce" checked> 総当たり攻撃</label>
                        <label><input type="radio" name="attackType" value="dictionary"> 辞書攻撃</label>
                    </div>
                </div>

                <div id="bruteForceOptions">
                    <div class="radio-buttons-wrapper" style="margin-bottom: 15px;">
                        <label><input type="radio" name="bruteForceScenario" value="length" checked> シナリオA: 長さ優先</label>
                        <label><input type="radio" name="bruteForceScenario" value="chars"> シナリオB: 文字種優先</label>
                        <label><input type="radio" name="bruteForceScenario" value="real"> シナリオC: 全探索</label>
                        <label style="color:#c0392b; font-weight:bold;"><input type="radio" name="bruteForceScenario" value="lock"> シナリオD: 現実的な挙動 (ロックあり)</label>
                    </div>
                </div>
                
                <div class="button-row">
                    <button id="analyzeButton">解析シミュレーション開始</button>
                    <button id="stopButton" class="action-btn-red hidden">中断する</button> 
                    <button id="showCalcDetailBtn" class="action-btn-gray" style="width: auto;">詳細な計算式を表示</button>
                </div>
            </div>

            <div class="simulation-section hidden" id="simulationSection">
                <h2>実行ログ</h2>
                <div class="status-dashboard">
                    <div class="status-item">
                        <span class="status-label">TOTAL ATTEMPTS</span>
                        <span class="status-value" id="realtimeAttempts">0</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">ESTIMATED TIME</span>
                        <span class="status-value" id="realtimeTimer">Calculating...</span>
                    </div>
                </div>
                <div class="simulation-display" id="simulationDisplay"></div>
            </div>
        </div>

        <div id="section-login" class="tab-content">
            <div class="input-section login-simulation-wrapper">
                <h2>実践ログイン & 防御機構</h2>
                <p>Tab 1, 3 で特定した情報を使って、実際にログインできるか試します。</p>

                <div id="hackerMemo" class="hacker-memo hidden">
                    <div class="memo-tape"></div>
                    <h4>📝 攻撃メモ</h4>
                    <p id="hackerMemoText"></p>
                </div>

                <div class="server-config-panel">
                    <div class="config-label">⚙️ サーバーセキュリティ設定 (管理者用)</div>
                    <div class="defense-toggle">
                        <label class="toggle-switch">
                            <input type="checkbox" id="twoFactorToggle">
                            <span class="slider round"></span>
                        </label>
                        <span class="toggle-text">2FA (二段階認証) を有効化</span>
                    </div>
                </div>

                <div class="login-split-view">
                    <div class="login-card">
                        <h3>社内ポータル ログイン</h3>
                        
                        <div class="form-group">
                            <label>ユーザーID</label>
                            <input type="text" id="demoLoginId" placeholder="IDを入力">
                        </div>
                        <div class="form-group">
                            <label>パスワード</label>
                            <input type="password" id="demoLoginPass" placeholder="パスワードを入力">
                        </div>
                        
                        <button id="demoLoginBtn" class="action-btn-blue full-width">ログイン</button>
                        
                        <button id="lockoutResetBtn" class="action-btn-gray hidden" style="margin-top:10px;">[管理者] ロック解除</button>
                    </div>

                    <div class="hacked-list-box">
                        <h3>ℹ️ ステータス</h3>
                        <div id="loginStatusArea" style="min-height: 50px; display:flex; align-items:center; justify-content:center;">
                            <p id="loginStatusText" style="color:#666;">ログイン操作を行ってください...</p>
                        </div>
                        
                        <div id="confidentialDataArea" class="confidential-box hidden">
                            <div class="confidential-header">CONFIDENTIAL // 社外秘</div>
                            <div style="padding:10px;">
                                <h4 style="margin:5px 0; color:#c0392b; text-align:center;">⚠️ 顧客名簿 (流出)</h4>
                                <table class="data-table">
                                    <thead><tr><th>ID</th><th>氏名</th><th>住所</th><th>電話番号</th></tr></thead>
                                    <tbody>
                                        <tr><td>001</td><td>山田 太郎</td><td>東京都千代田区...</td><td>090-1111-xxxx</td></tr>
                                        <tr><td>002</td><td>鈴木 花子</td><td>大阪府大阪市...</td><td>080-2222-xxxx</td></tr>
                                        <tr><td>003</td><td>佐藤 健</td><td>北海道札幌市...</td><td>070-3333-xxxx</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="section-spray" class="tab-content">
            <div class="input-section">
                <h2>パスワードスプレー攻撃</h2>
                <p>組織内に実在する「ユーザーID」を特定し、ありがちな「弱いパスワード」を一斉に試行します。</p>
                
                <div class="step-box">
                    <h3>Step 1: ユーザーIDの探索 (Account Enumeration)</h3>
                    <p>
                        Webシステムの「エラーメッセージの差異」を悪用し、実在するIDを特定します。
                    </p>
                    <button id="enumerateUsersBtn" class="action-btn-blue">IDリスト探索を実行</button>
                    
                    <div id="enumLogDisplay" class="simulation-display hidden" style="height: 150px; margin-top:10px;"></div>

                    <div id="foundUsersArea" class="hidden" style="margin-top:15px;">
                        <p><strong>発見された有効なID:</strong></p>
                        <div id="userListDisplay" class="user-tags"></div>
                    </div>
                </div>

                <div id="sprayStepBox" class="step-box hidden">
                    <h3>Step 2: パスワードスプレーの実行</h3>
                    <p>発見した全ユーザーに対して、指定したパスワードでログインを試みます。</p>
                    <label>試行するパスワードを選択:</label>
                    <div class="spray-controls">
                        <select id="sprayPasswordSelect">
                            <option value="password">password (危険)</option>
                            <option value="123456">123456 (危険)</option>
                            <option value="baseball">baseball (趣味)</option>
                            <option value="admin123">admin123 (ありがち)</option>
                            <option value="qwerty">qwerty (配列)</option>
                        </select>
                        <button id="executeSprayBtn" class="action-btn-red">一斉攻撃開始</button>
                    </div>
                    <div class="simulation-display spray-log" id="sprayResultDisplay"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="guidanceBar" class="guidance-bar hidden">
        <span id="guidanceText">ここにメッセージを表示</span>
        <button id="guidanceActionBtn">次へ進む</button>
        <button class="guidance-close" onclick="document.getElementById('guidanceBar').classList.add('hidden')">&times;</button>
    </div>

    <div id="systemDialog" class="modal-overlay hidden">
        <div class="modal-content dialog-content">
            <div id="dialogIcon" class="dialog-icon">⚠️</div>
            <h3 id="dialogTitle">System Message</h3>
            <p id="dialogMessage">Content goes here.</p>
            <button id="dialogOkBtn" class="action-btn-blue" style="width: auto; padding: 8px 30px; margin-top:15px;">OK</button>
        </div>
    </div>

    <div id="twoFactorModal" class="modal-overlay hidden">
        <div class="modal-content dialog-content" style="border-top: 5px solid #27ae60;">
            <div class="dialog-icon" style="font-size:2.5em; margin-bottom:5px;">📱</div>
            <h3 style="margin-top:0;">二段階認証</h3>
            <p style="font-size:0.9em; color:#666;">
                新しいデバイスからのログインを検知しました。<br>
                登録された携帯電話番号 (***-****-9988) に送信された6桁の認証コードを入力してください。
            </p>
            
            <div style="margin: 20px 0;">
                <input type="text" id="twoFactorInput" placeholder="123456" maxlength="6" 
                    style="font-size: 1.5em; letter-spacing: 5px; text-align: center; width: 200px; padding: 10px;">
            </div>

            <button id="verify2FABtn" class="action-btn-blue full-width">認証する</button>
            <div id="twoFactorError" class="hidden" style="color:#e74c3c; font-weight:bold; margin-top:10px;">コードが間違っています</div>

            <p style="font-size:0.8em; color:#888; margin-top:20px; border-top:1px solid #eee; padding-top:10px;">
                <strong>解説:</strong> 攻撃者は被害者のスマホを持っていないため、IDとパスワードを知っていてもここでブロックされます。
            </p>
            <button class="modal-close" style="top:10px; right:15px; font-size:24px;">&times;</button>
        </div>
    </div>

    <div id="calculationModal" class="modal-overlay hidden">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h2>解析時間の推定計算</h2>
            <div class="modal-options">
                <label for="threatModelSelect">攻撃環境:</label>
                <select id="threatModelSelect">
                    <option value="pc">一般的なPC</option>
                    <option value="gpu">高性能GPU</option>
                    <option value="cloud">クラウド規模攻撃</option>
                </select>
            </div>
            <hr>
            <div id="calculationDetails"></div>
        </div>
    </div>

    <script src="script.js"></script>
    <footer>
        <div>©VISUSEC 2022-2026 <a href="https://visusec.jp/license/" target="_blank">利用規約</a></div>
        <div>パスワード攻撃・防御シミュレータ Ver.3（2026.01.18）[Origin 2025.12.14]</div>
    </footer>
</body>
</html>